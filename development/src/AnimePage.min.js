(function(n,t){t.namespace("E$.ui",function(i){var r=t.structs.Vector2,u=t.klass({ctor:function(n,t){this.type=n;this.key=t},type:null,key:null,getEl:function(){}}),f=t.klass(u,{ctor:function(n,t){f.Base.ctor.call(this,"img",n);this.prefix=t||"p"},prefix:null,getEl:function(){return n(String.format(s,this.getPath()))},getPath:function(){return String.format("images/static/{0}{1}.jpg",this.prefix,this.key)}}),e=t.klass(f,{ctor:function(n,t,i){e.Base.ctor.call(this,n,t);this.link=i||"#"},link:null,getEl:function(){var i=this,t=e.Base.getEl.call(this),n;t.on("touchstart mousedown",function(t){n=r.fromEvent(t)}).on("touchend mouseup",function(t){var u=r.fromEvent(t);r.distance(u,n)<3&&u.elapse(n)<100&&(window.location=i.link)});return t}}),o=t.klass(u,{ctor:function(t,i,r){r=r||{};o.Base.ctor.call(this,"stage",t);this.el=n('<canvas width="640" height="960"><\/canvas>');this.lKey=i;this.transparent=r.transparent;this.replay=r.replay},el:null,root:null,transparent:!0,replay:!0,getEl:function(){return n('<div class="element"/>').append(this.el)},getProperties:function(){var n=window[this.lKey];return n.properties},getManifest:function(){return this.getProperties().manifest},getStage:function(){this.el.css("background-color",this.getProperties().color);var t=new window[this.lKey][this.key],n=new createjs.Stage(this.el.get(0));return n.addChild(t),n.update(),this.root=t,n}}),s;t.extends(i,{sliders:{SliderElement:u,ImgEl:f,LinkedImgEl:e,StageEl:o}});s='<div class="element" style="background-image:url({0});"><\/div>';t.using(["E$.ui","E$.structs.Vector2"],function(r,u){var f=t.klass({ctor:function(i,f){function v(n){n.item.type=="image"&&(images[n.item.id]=n.result)}function l(){e.append(h);n(".loading").fadeOut(1e3,function(){n(this).remove()});var r=o[0],u;r&&(u=r.getProperties(),createjs.Ticker.setFPS(u.fps),t.each(o,function(n,t){var i=t.getStage();t.root.tickEnabled=!1;createjs.Ticker.addEventListener("tick",i)}));i[0]==r&&(r.root.tickEnabled=!0)}var a=this,s;f=f||{};var e=n(".gallery-wrapper"),h=n('<div class="gallery-slider"><\/div>'),o=[],c=[];t.each(i,function(n,t){t.type==="stage"&&(o.push(t),c.push.apply(c,t.getManifest()));h.append(t.getEl())});s=new createjs.LoadQueue(!1);s.addEventListener("fileload",v);s.addEventListener("complete",l);s.loadManifest(c);a.touchGallery=new r.TouchGallery({axis:u.BOTTOM,transformObj:h,itemsLength:i.length,eventTarget:e[0],transitionDuration:500,threshold:5,viewportSize:new u(e.width(),e.height()),onDown:function(){t.each(i,function(n,t){t.type==="stage"&&(t.root.tickEnabled=!1)})},onTap:function(n){var t=i[n];t.type==="stage"&&(t.root.tickEnabled=!0)},onDone:function(n){setTimeout(function(){t.each(i,function(t,i){if(i.type==="stage"){var r=t===n;i.replay&&(r?i.root.getChildAt(0).gotoAndPlay(1):i.root.getChildAt(0).gotoAndStop(0));i.transparent&&(i.root.alpha=r);i.root.tickEnabled=r}})},510)}});o.length===0&&l()}});t.extends(i,{anime:{PageBase:f}})})})})(jQuery,EES);