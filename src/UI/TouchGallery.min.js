(function(n,t){t.using(["E$.structs.Vector2","E$.components.basic.TouchMonitor"],function(i,r){t.namespace("E$.ui",function(u){var f=t.klass({ctor:function(t){this.$el=n(t)},$el:null,moveTo:function(n){this.$el.css("transform","translate3d("+n.x+"px,"+n.y+"px,0)")},setAnimateDuration:function(n){this.$el.css({"transition-duration":n+"ms"})},destroy:function(){this.$el&&(delete this.$el,this.$el=null)}}),e=t.klass({ctor:function(n){var v=this,e=i.ORIGIN,o=i.trend(n.axis||i.RIGHT),l=n.viewportSize||new i(1024,768),y=l.divide(2).multiply(o),u=n.currentIndex||0,h=n.itemsLength||0,p=n.threshold||30,w=n.timeThreshold||500,s=new f(n.transformObj),a=n.transitionDuration||500,c=i.ORIGIN,b=n.eventTarget,k;e=l.multiply(u*-1).multiply(o);s.setAnimateDuration(0);s.moveTo(e);s.setAnimateDuration(a);k=new r({preventDefault:n.preventDefault,stopPropagation:n.stopPropagation,capture:n.capture,onDown:function(t){if(c=i.fromEvent(t).multiply(o),s.setAnimateDuration(0),n.onDown)n.onDown(u,t)},onMove:function(t){var f=i.fromEvent(t).multiply(o),r=f.subtract(c),v=i.distance(c,f),l,a;if(v>p){if(l=u===0&&(r.x>0||r.y>0)||u==h-1&&(r.x<0||r.y<0)?e.addition(r.divide(2)):e.addition(r),n.onMove&&(a=n.onMove(u,t,r),a===C$.RETURN))return;s.moveTo(l)}},onUp:function(t){var f=i.fromEvent(t).multiply(o),g=f.subtract(c),v=e.copy(),b=i.distance(c,f),k,r,d,nt;if(s.setAnimateDuration(a),b>p){if((f.elapse(c)<w||b>y.x||b>y.y)&&(r=i.trend(g),d=r.multiply(l).multiply(o),r.x<0||r.y<0?u<h-1&&(v=e.addition(d),k=!0):(r.x>0||r.y>0)&&u>0&&(v=e.addition(d),k=!0)),n.onUp&&(nt=n.onUp(u,t,g,k),nt===C$.RETURN))return;e=v.copy();o.x===1?u=e.divide(l.x).x*-1:o.y===1&&(u=e.divide(l.y).y*-1);setTimeout(function(){if(s.moveTo(e),n.onDone)n.onDone(u)},10)}else f.elapse(c)<w&&n.onTap&&n.onTap(u)}}).bind(b);t(v).extra({setIndex:function(t){if(-1<t&&t<h&&(e=l.multiply(t*-1).multiply(o),s.setAnimateDuration(a),s.moveTo(e),u=t,n.onDone))n.onDone(u)},getIndex:function(){return u},getLength:function(){return h},setLength:function(n){n<0&&(n=0);h=n;h<=u&&v.setIndex(h-1)}})}});t.extends(u,{DOM2DMovableElement:f,TouchGallery:e})})})})(jQuery,EES);