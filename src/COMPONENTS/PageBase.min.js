(function(n,t){t.namespace("E$.components",function(n){function u(n,i){t.isFunction(n)?n(i):S$.getType(n)=="object"&&n.onLayoutReady&&n.onLayoutReady(i)}var r={NORMAL:1,IFRAME:2,EDGE:3,TEMPLATE:4,SPECIALITY:5},f=t.klass({init:function(t,i,u){this.isReady=!1;this.$root=null;this.$tmpl=null;this.name=t||this.name||"noname";this.pageType=i||this.pageType||r.NORMAL;this.target=u||this.target||"body";this.readyListeners=new n.collections.List},isReady:!1,$root:null,$tmpl:null,name:"noname",pageType:r.NORMAL,target:"body",readyListeners:null,hasInnerAnime:!1,ready:function(n){var i=this;if(!n){i.isReady&&t.each(i.readyListeners,function(n,t){u(t,i)});return}i.isReady?u(n,i):i.readyListeners.add(n)},destroy:function(){this.$root&&(t.helpers.tmpl.safeRemove(this.$root),delete this.$tmpl,this.$tmpl=null,delete this.$root,this.$root=null);delete this.readyListeners;this.readyListeners=null},show:function(n,t){this.$root&&this.$root.fadeIn(n,t)},delayShow:function(n,t,i){this.$root&&this.$root.delay(n).fadeIn(t,i)},hide:function(n,t){this.$root&&this.$root.fadeOut(n,t)}},{find:function(n){return this.$root.find(n)}},{beforeLeave:function(){},afterLeave:function(){},beforeEnter:function(){},afterEnter:function(){},setStageLevel:function(n,t){t&&this.$root[0].addEventListener("webkitTransitionEnd",t);this.$root.addClass(n)},resumeStageLevel:function(n){onTransitinEnd&&this.$root[0].addEventListener("webkitTransitionEnd",onTransitinEnd);this.$root.removeClass(n)},nextSubPage:function(){return!1},prevSubPage:function(){return!1}},{setNewStage:function(n,i){var u=t.isFunction(n)?n:i,r=t.isString(n)?n:!1;u&&this.$root[0].addEventListener("webkitTransitionEnd",u);!this.preProcessed&&r&&this.$root.addClass(r);this.preProcessed?this.$root.removeClass(r):this.$root.show().removeClass(r)},setOldStage:function(n,i){var r=t.isFunction(n)?n:i,u=t.isString(n)?n:!1;r&&this.$root[0].addEventListener("webkitTransitionEnd",r);u&&this.$root.addClass(u)},restoreStage:function(n){var i=t.isString(n)?n:!1;i&&this.$root.removeClass(n)}}),o=t.klass(f,{pageCount:0,currentPage:1,pageWidth:0,initialize:function(){},nextSubPage:function(){},prevSubPage:function(){}}),i={NONE:0,READY:1,CLOSE:2,READYANDCLOSE:3},e=t.klass({ctor:function(n){this.owner=n.owner;this.syncStage=n.syncStage;this.syncMode=n.syncMode||0;this.syncTransition=n.syncTransition;this.transition=n.transition;this.onTransitionEnd=n.onTransitionEnd||function(){}},owner:null,syncStage:null,syncMode:0,syncTransition:"",current:null,onPreReady:function(n){n&&(n.$root.addClass(this.transition).show(),n.preProcessed=!0)},onLayoutReady:function(n){function r(i){if(i.target==n.$root[0]){i.target.removeEventListener("webkitTransitionEnd",r,!1);t.onTransitionEnd("opened",n,i);t.current=n;n.afterEnter()}}var t=this;n.beforeEnter();t.syncStage&&t.syncMode&i.READY===i.READY&&t.syncStage.setOldStage(t.syncTransition);n.setNewStage(t.transition,r)},onStageClose:function(n){if(n){var t=this;function r(i){if(i.target==n.$root[0]){i.target.removeEventListener("webkitTransitionEnd",r,!1);var u=t.onTransitionEnd("closed",n,i);n.afterLeave();u&&(n.destroy(),n==t.current&&(t.current=null))}}n.beforeLeave();t.syncStage&&t.syncMode&i.CLOSE===i.CLOSE&&t.syncStage.restoreStage(t.syncTransition);n.$root.hasClass(t.transition)?r({target:n.$root[0]}):n.setOldStage(t.transition,r)}},destroy:function(){this.current&&(this.current.beforeLeave&&this.current.beforeLeave(),this.current.afterLeave&&this.current.afterLeave(),this.current.destroy&&this.current.destroy(),delete this.current,this.current=null)}});t.extends(t.components,{PageType:r,PageBase:f,PageHandler:e,PageHandlerSyncMode:i})})})(jQuery,EES);